<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VixTheWiz</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" type="image/png" href="favicon.png">
</head>
<body>
    <main>
        <section class="hero">
            <img src="profile.png" alt="Your Name" class="profile-photo">
            <h1>VixTheWiz</h1>
            <p class="tagline">Cloud Builder & AWS Enthusiast</p>
            
            <a href="https://builder.aws.com/community/@vixthewiz" target="_blank" class="aws-link">AWS Builder Center Profile</a>
            <p class="scroll-link">
                <a href="#league-lookup">Try my League Data Lookup ‚Üì</a>
            </p>
        </section>

        <section class="fun-facts">
            <h3>Fun Facts About Me</h3>
            <div class="facts-grid">
                <div class="fact-card">
                    <h4>üöÄ Challenge In Progress</h4>
                    <p>Currently working on <a href="https://builder.aws.com/content/32Z4SrTB8V1g0mMUGmyMUWXVgsu/rift-rewind-hackathon-on-aws-builder-center" target="_blank">AWS Builder Challenge: Rift Rewind Hackaton</a></p>
                </div>
                <div class="fact-card">
                    <h4>üéØ Learning Goal</h4>
                    <p>Building my skills one AWS service at a time - Lambda, Systems manager and beyond!</p>
                </div>
                <div class="fact-card">
                    <h4>üí° Fun Project</h4>
                    <p>This website is hosted on AWS through Amplify with CloudFront for global delivery!</p>
                </div>
            </div>
        </section>

        <section class="aws-journey">
            <h3>My current project</h3>
            <p>I'm currently working on the "Rift Rewind Hackathon on AWS Builder Center" challenge. This site is part of my challenge progress!</p>
            <a href="https://builder.aws.com/content/32Z4SrTB8V1g0mMUGmyMUWXVgsu/rift-rewind-hackathon-on-aws-builder-center" target="_blank" class="cta-button">View Challenge Details</a>
        </section>

        <!-- LEAGUE DATA LOOKUP SECTION -->
        <section id="league-lookup" class="league-lookup">
            <h3>League Data Lookup</h3>
            <p>Enter a Riot ID to see their level and top champions!</p>
    
        <!-- Lookup message container for success/error messages -->
        <div id="lookup-message" class="lookup-message" style="display: none;"></div>
    
        <div class="lookup-form-container">
        <!-- Riot ID lookup form -->
        <div class="form-group">
            <label for="summoner-name">Riot ID</label>
            <input type="text" id="summoner-name" name="summoner-name" placeholder="GameName#TAG (e.g., Hide on bush#KR1)" required>
            <small style="color: #687078; display: block; margin-top: 4px;">Format: GameName#TAG</small>
        </div>
        <div class="form-group">
            <label for="region">Region</label>
            <select id="region" name="region">
                <option value="na1">North America</option>
                <option value="euw1">Europe West</option>
                <option value="eun1">Europe Nordic & East</option>
                <option value="kr">Korea</option>
                <option value="br1">Brazil</option>
                <option value="la1">Latin America North</option>
                <option value="la2">Latin America South</option>
                <option value="oc1">Oceania</option>
                <option value="tr1">Turkey</option>
                <option value="ru">Russia</option>
                <option value="jp1">Japan</option>
            </select>
        </div>
        <!-- Lookup submit button -->
        <button type="button" id="lookup-btn" class="lookup-submit-btn">Look Up Summoner</button>
        </div>

    <!-- Results display area -->
    <div id="summoner-results" class="summoner-results" style="display: none;">
        <h4>Summoner Info</h4>
        <div id="summoner-info"></div>
        <div id="champion-mastery"></div>
    </div>
</section>
<!-- END LEAGUE DATA LOOKUP SECTION -->
    </main>

    <footer>
        <p>&copy; 2025 Victoria @VixTheWiz. Built with ‚ù§Ô∏è on AWS</p>
    </footer>
    
    <script>
    // League Data Lookup - Calls Riot API via Lambda
    const RIOT_API_URL = 'https://drkwtz22yumgqdhn2u5xa2knie0vijnw.lambda-url.us-east-1.on.aws/'; // Lambda Function URL
    
    document.addEventListener('DOMContentLoaded', function() {
        const lookupBtn = document.getElementById('lookup-btn');
        const summonerNameInput = document.getElementById('summoner-name');
        const regionSelect = document.getElementById('region');
        
        lookupBtn.addEventListener('click', async function() {
            const summonerName = summonerNameInput.value.trim();
            const region = regionSelect.value;
            const messageDiv = document.getElementById('lookup-message');
            const resultsDiv = document.getElementById('summoner-results');
            
            if (!summonerName) {
                showMessage('Please enter a Riot ID', 'error');
                return;
            }
            
            if (!summonerName.includes('#')) {
                showMessage('Please use Riot ID format: GameName#TAG', 'error');
                return;
            }
            
            // Show loading state
            lookupBtn.textContent = 'Looking up...';
            lookupBtn.disabled = true;
            messageDiv.style.display = 'none';
            resultsDiv.style.display = 'none';
            
            try {
                const response = await fetch(RIOT_API_URL, {
                    method: 'POST',
                    headers: {
                        'Content-Type': 'application/json',
                    },
                    body: JSON.stringify({
                        summonerName: summonerName,
                        region: region
                    })
                });
                
                const data = await response.json();
                
                if (response.ok) {
                    await renderResults(data);
                    document.getElementById('summoner-results').style.display = 'block';
                    showMessage('Summoner found!', 'success');
                } else {
                    showMessage(data.error || 'Failed to fetch summoner data', 'error');
                }
            } catch (error) {
                console.error('Error:', error);
                showMessage('Network error. Please try again.', 'error');
            }
            
            // Reset button
            lookupBtn.textContent = 'Look Up Summoner';
            lookupBtn.disabled = false;
        });
        
        // Enter key support
        summonerNameInput.addEventListener('keypress', function(e) {
            if (e.key === 'Enter') {
                lookupBtn.click();
            }
        });
    });
    
       function showMessage(text, type) {
        const messageDiv = document.getElementById('lookup-message');
        messageDiv.textContent = text;
        messageDiv.className = `lookup-message ${type}`;
        messageDiv.style.display = 'block';
        
        // Auto-hide after 10 seconds
        setTimeout(() => {
            messageDiv.style.display = 'none';
        }, 10000);
    }
</script>
<script>
/* ========= DDragon champion map + images (cached) ========= */
(function(){
  const DAY = 24*60*60*1000;
  const FALLBACK_VER = "14.19.1"; // safe hard fallback for images

  // Expose a single global you can await anywhere
  window.CHAMP = {
    version: null,
    byId: {},       // e.g. {103:"Ahri"}
    slugById: {},   // e.g. {103:"Ahri"}  // used for image filenames
    ready: null     // Promise that resolves when map is loaded
  };

  function setCache(k,v,ttl){ sessionStorage.setItem(k, JSON.stringify({v, t:Date.now(), ttl: ttl||DAY*7})); }
  function getCache(k){
    try{ const o = JSON.parse(sessionStorage.getItem(k)); if(!o) return null;
         if(Date.now() - o.t > (o.ttl||DAY*7)) return null; return o.v; }catch(_){ return null; }
  }

 async function getLatestVersion(){
    const cached = getCache('dd_version'); if (cached) return cached;
    try{
      const r = await fetch("https://ddragon.leagueoflegends.com/api/versions.json",{cache:"no-store"});
      const arr = await r.json();
      const latest = Array.isArray(arr)&&arr.length ? arr[0] : FALLBACK_VER;
      setCache('dd_version', latest, DAY);
      return latest;
    }catch(_){
      return FALLBACK_VER; // üëà ensures images always have a concrete version
    }
  }

  async function getChampionMap(version){
    const key = `dd_champmap_${version}`;
    const cached = getCache(key); if (cached) return cached;
    const r = await fetch(`https://ddragon.leagueoflegends.com/cdn/${version}/data/en_US/champion.json`,{cache:"no-store"});
    const data = await r.json();
    const byId={}, slugById={};
    for(const obj of Object.values(data.data)){
      const id = parseInt(obj.key,10);
      byId[id] = obj.name;   // display name
      slugById[id] = obj.id; // filename slug for images
    }
    const packed = {byId, slugById};
    setCache(key, packed, DAY*7);
    return packed;
  }

  window.CHAMP.ready = (async ()=>{
    const ver = await getLatestVersion();
    const {byId, slugById} = await getChampionMap(ver);
    window.CHAMP.version = ver;
    window.CHAMP.byId = byId;
    window.CHAMP.slugById = slugById;
  })();
})();
</script>
<script>
async function renderResults(data){
  // Wait for champion map to be ready
  if (window.CHAMP?.ready) { await window.CHAMP.ready; }

  // Summoner card 
  const card = document.querySelector('.summoner-card');
  if (card && data?.summoner){
    card.innerHTML = `
      <h5>${data.summoner.name}</h5>
      <p>Level ${data.summoner.level ?? '‚Äî'}</p>
    `;
  }

  // Champions grid with image + text
  const grid = document.querySelector('.champions-grid');
  if (!grid) return;
  grid.innerHTML = '';

  const champs = data?.topChampions || [];
  champs.forEach(c => {
    const id   = Number(c.championId);
    const name = window.CHAMP.byId[id] || `ID ${id}`;
    const slug = window.CHAMP.slugById[id];
    const ver  = window.CHAMP.version || "14.19.1";
    const img  = slug ? `https://ddragon.leagueoflegends.com/cdn/${ver}/img/champion/${slug}.png` : '';

    const el = document.createElement('div');
    el.className = 'champion-card';
    el.innerHTML = `
      ${img ? `<img class="champ-icon" src="${img}" alt="${name}" width="64" height="64"
                 loading="lazy" onerror="this.style.display='none'">` : ''}
      <div class="champ-meta">
        <p><strong>${name}</strong></p>
        <p>Mastery Level: ${c.championLevel}</p>
        <p>Mastery Points: ${(c.championPoints||0).toLocaleString()}</p>
      </div>
    `;
    grid.appendChild(el);
  });

  // optional: scroll results into view
  document.querySelector('.summoner-results')?.scrollIntoView({behavior:'smooth', block:'start'});
}
</script>

<script>
{
  const grid = document.querySelector('.champions-grid');
  const card = document.querySelector('.summoner-card');
  if (!grid) return;

  // Summoner card (keeps your current structure)
  if (card && data?.summoner){
    card.innerHTML = `
      <h5>${data.summoner.name}</h5>
      <p>Level ${data.summoner.level ?? '‚Äî'}</p>
    `;
  }

  // Champions
  grid.innerHTML = '';
  const champs = data?.topChampions || [];
  champs.forEach(c => {
    const name = (window.CHAMP.byId && window.CHAMP.byId[c.championId]) || `ID ${c.championId}`;
    const slug = (window.CHAMP.slugById && window.CHAMP.slugById[c.championId]) || null;
    const ver  = window.CHAMP.version || 'latest';
    const img  = slug ? `https://ddragon.leagueoflegends.com/cdn/${ver}/img/champion/${slug}.png` : '';

    const div = document.createElement('div');
    div.className = 'champion-card';
    div.innerHTML = `
      ${img ? `<img class="champ-icon" src="${img}" alt="${name}" width="64" height="64" loading="lazy">` : ''}
      <p><strong>${name}</strong></p>
      <p>Level ${c.championLevel}</p>
      <p>${(c.championPoints || 0).toLocaleString()} pts</p>
    `;
    grid.appendChild(div);
  });
}
</script>
<script>
// Smooth scroll for all same-page links
document.querySelectorAll('a[href^="#"]').forEach(a => {
  a.addEventListener('click', e => {
    const targetId = a.getAttribute('href').slice(1);
    const targetEl = document.getElementById(targetId);
    if (targetEl) {
      e.preventDefault();
      targetEl.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }
  });
});
</script>

</body>
</html>

<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VixTheWiz</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" type="image/png" href="favicon.png">
</head>
<body>
    <main>
        <section class="hero">
            <img src="profile.png" alt="Your Name" class="profile-photo">
            <h1>VixTheWiz</h1>
            <p class="tagline">Cloud Builder & AWS Enthusiast</p>
            
            <a href="https://builder.aws.com/community/@vixthewiz" target="_blank" class="aws-link">AWS Builder Center Profile</a>
            <p class="scroll-link">
                <a href="#league-lookup">Try my League Data Lookup ‚Üì</a>
            </p>
        </section>

        <section class="fun-facts">
            <h3>Fun Facts About Me</h3>
            <div class="facts-grid">
                <div class="fact-card">
                    <h4>üöÄ Challenge In Progress</h4>
                    <p>Currently working on <a href="https://builder.aws.com/content/32Z4SrTB8V1g0mMUGmyMUWXVgsu/rift-rewind-hackathon-on-aws-builder-center" target="_blank">AWS Builder Challenge: Rift Rewind Hackaton</a></p>
                </div>
                <div class="fact-card">
                    <h4>üéØ Learning Goal</h4>
                    <p>Building my skills one AWS service at a time - Lambda, Systems manager and beyond!</p>
                </div>
                <div class="fact-card">
                    <h4>üí° Fun Project</h4>
                    <p>This website is hosted on AWS through Amplify with CloudFront for global delivery!</p>
                </div>
            </div>
        </section>

        <section class="aws-journey">
            <h3>My current project</h3>
            <p>I'm currently working on the "Rift Rewind Hackathon on AWS Builder Center" challenge. This site is part of my challenge progress!</p>
            <a href="https://builder.aws.com/content/32Z4SrTB8V1g0mMUGmyMUWXVgsu/rift-rewind-hackathon-on-aws-builder-center" target="_blank" class="cta-button">View Challenge Details</a>
        </section>

        <!-- LEAGUE DATA LOOKUP SECTION -->
        <section id="league-lookup" class="league-lookup">
            <h3>League Data Lookup</h3>
            <p>Enter a Riot ID to see their level and top champions!</p>
    
        <!-- Lookup message container for success/error messages -->
        <div id="lookup-message" class="lookup-message" style="display: none;"></div>
    
        <div class="lookup-form-container">
        <!-- Riot ID lookup form -->
        <div class="form-group">
            <label for="summoner-name">Riot ID</label>
            <input type="text" id="summoner-name" name="summoner-name" placeholder="GameName#TAG (e.g., Hide on bush#KR1)" required>
            <small style="color: #687078; display: block; margin-top: 4px;">Format: GameName#TAG</small>
        </div>
        <div class="form-group">
            <label for="region">Region</label>
            <select id="region" name="region">
                <option value="na1">North America</option>
                <option value="euw1">Europe West</option>
                <option value="eun1">Europe Nordic & East</option>
                <option value="kr">Korea</option>
                <option value="br1">Brazil</option>
                <option value="la1">Latin America North</option>
                <option value="la2">Latin America South</option>
                <option value="oc1">Oceania</option>
                <option value="tr1">Turkey</option>
                <option value="ru">Russia</option>
                <option value="jp1">Japan</option>
            </select>
        </div>
        <!-- Lookup submit button -->
        <button type="button" id="lookup-btn" class="lookup-submit-btn">Look Up Summoner</button>
        </div>

    <!-- Results display area -->
    <div id="summoner-results" class="summoner-results" style="display: none;">
        <h4>Summoner Info</h4>
        <div id="summoner-info"></div>
        <div id="champion-mastery"></div>
    </div>
</section>
<!-- END LEAGUE DATA LOOKUP SECTION -->
    </main>

    <footer>
        <p>&copy; 2025 Victoria @VixTheWiz. Built with ‚ù§Ô∏è on AWS</p>
    </footer>
    
<script>    
// League Data Lookup - Calls Riot API via Lambda
const RIOT_API_URL = 'https://drkwtz22yumgqdhn2u5xa2knie0vijnw.lambda-url.us-east-1.on.aws/'; // Lambda Function URL

document.addEventListener('DOMContentLoaded', function() {
  const lookupBtn = document.getElementById('lookup-btn');
  const summonerNameInput = document.getElementById('summoner-name');
  const regionSelect = document.getElementById('region');

  lookupBtn.addEventListener('click', async function() {
    const summonerName = summonerNameInput.value.trim();
    const region = regionSelect.value;
    const resultsDiv = document.getElementById('summoner-results');

    if (!summonerName) { showMessage('Please enter a Riot ID', 'error'); return; }
    if (!summonerName.includes('#')) { showMessage('Please use Riot ID format: GameName#TAG', 'error'); return; }

    // loading state
    lookupBtn.textContent = 'Looking up...';
    lookupBtn.disabled = true;
    document.getElementById('lookup-message').style.display = 'none';
    resultsDiv.style.display = 'none';

    try {
      const response = await fetch(RIOT_API_URL, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ summonerName, region })
      });

      const data = await response.json();

      if (response.ok) {
        try {
          await renderResultsSimple(data);
          showMessage('Summoner found!', 'success');
        } catch (e) {
          console.error('[RR] renderResultsSimple failed:', e);
          showMessage('Render failed ‚Äî see console for details', 'error');
        }
        resultsDiv.style.display = 'block';
      } else {
        showMessage(data.error || 'Failed to fetch summoner data', 'error');
      }
    } catch (err) {
      console.error('Lookup error:', err);
      showMessage('Network or server error. See console for details.', 'error');
    } finally {
      lookupBtn.textContent = 'Look Up Summoner';
      lookupBtn.disabled = false;
    }
  });

  // Enter key support
  summonerNameInput.addEventListener('keypress', function(e) {
    if (e.key === 'Enter') lookupBtn.click();
  });
});

function showMessage(text, type) {
  const messageDiv = document.getElementById('lookup-message');
  messageDiv.textContent = text;
  messageDiv.className = `lookup-message ${type}`;
  messageDiv.style.display = 'block';
  setTimeout(() => { messageDiv.style.display = 'none'; }, 10000);
}
</script>

</script>

<script>
async function renderResultsSimple(payload){
  console.log("[RR] renderResultsSimple() called with payload:", payload);

  const wrap    = document.getElementById('summoner-results');
  const info    = document.getElementById('summoner-info');
  const mastery = document.getElementById('champion-mastery');

  // Hard guard: if any container missing, print a visible message so you can see it on-page.
  if (!wrap || !info || !mastery){
    console.error("[RR] Missing container(s). wrap:", !!wrap, "info:", !!info, "mastery:", !!mastery);
    const target = document.querySelector('#summoner-results') || document.body;
    target.innerHTML = `
      <div style="padding:12px;border:1px solid #6b1e2a;background:#2b1318;color:#ffb3b3;border-radius:8px;margin-top:12px">
        <strong>Renderer error:</strong> Missing one or more containers
        (#summoner-results, #summoner-info, #champion-mastery).
      </div>`;
    return;
  }

  // Always show the section
  wrap.style.display = 'block';

  // ---- Summoner card ----
  const s = (payload && payload.summoner) || {};
  info.innerHTML = `
    <div class="summoner-card">
      <h5>${escapeHtml(s.name || 'Unknown Summoner')}</h5>
      <p>Level: ${s.level ?? s.summonerLevel ?? '‚Äî'}</p>
      ${s.puuid ? `<p class="mono">PUUID: ${escapeHtml(s.puuid)}</p>` : ''}
    </div>
  `;

  const champs = Array.isArray(payload?.topChampions) ? payload.topChampions : [];
  if (!champs.length){
    console.warn("[RR] No topChampions found in payload.");
    mastery.innerHTML = `
      <div class="subtle" style="padding:8px 0">No champion mastery data returned.</div>
      <details style="margin-top:8px"><summary>Debug: show raw payload</summary>
        <pre style="white-space:pre-wrap">${escapeHtml(JSON.stringify(payload, null, 2))}</pre>
      </details>`;
    return;
  }

  // ---- DDragon: version + champ map ----
  let version = 'latest';
  try {
    const vers = await fetch('https://ddragon.leagueoflegends.com/api/versions.json').then(r=>r.json());
    version = Array.isArray(vers) && vers.length ? vers[0] : '14.19.1';
  } catch(e) {
    console.warn("[RR] Failed to get versions.json, falling back:", e);
    version = '14.19.1';
  }

  let mapByKey = {};
  try {
    const data = await fetch(`https://ddragon.leagueoflegends.com/cdn/${version}/data/en_US/champion.json`).then(r=>r.json());
    for (const id in data.data){
      const c = data.data[id];
      mapByKey[String(c.key)] = { slug: c.id, name: c.name };
    }
  } catch(e) {
    console.warn("[RR] Failed to load champion.json; will show numeric IDs:", e);
  }

  const cards = champs.map(c=>{
    const meta = mapByKey[String(c.championId)];
    const name = meta?.name ?? `ID ${c.championId}`;
    const slug = meta?.slug;
    const img  = slug ? `https://ddragon.leagueoflegends.com/cdn/${version}/img/champion/${slug}.png` : '';
    const lvl  = c.championLevel ?? '‚Äî';
    const pts  = (c.championPoints ?? 0).toLocaleString();

    return `
      <div class="champion-card">
        ${img ? `<img class="champ-icon" src="${img}" alt="${escapeHtml(name)}" width="64" height="64" loading="lazy">` : ''}
        <div>
          <div><strong>${escapeHtml(name)}</strong></div>
          <div class="subtle">Level ${lvl} ‚Ä¢ ${pts} pts</div>
        </div>
      </div>`;
  }).join('');

  mastery.innerHTML = `
    <h5>Top Champions</h5>
    <div class="champions-grid">${cards}</div>
    <details style="margin-top:8px"><summary>Debug: show raw payload</summary>
      <pre style="white-space:pre-wrap">${escapeHtml(JSON.stringify(payload, null, 2))}</pre>
    </details>
  `;
}

function escapeHtml(s){
  return String(s ?? '').replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));
}
</script>

<script>
// Smooth scroll for all same-page links
document.querySelectorAll('a[href^="#"]').forEach(a => {
  a.addEventListener('click', e => {
    const targetId = a.getAttribute('href').slice(1);
    const targetEl = document.getElementById(targetId);
    if (targetEl) {
      e.preventDefault();
      targetEl.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }
  });
});
</script>

</body>
</html>

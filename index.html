<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VixTheWiz</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" type="image/png" href="favicon.png">
</head>
<body>
    <main>
  <!-- Hero Section -->
  <section class="hero">
    <img src="profile.png" alt="Your Name" class="profile-photo">
    <h1>VixTheWiz</h1>
    <p class="tagline">Cloud Builder & AWS Enthusiast</p>
    <p class="scroll-link">
      <a href="#league-lookup">Try my League of Legends Player Lookup ‚Üì</a>
    </p>

    <!-- Tab Bar -->
    <div class="tab-bar">
      <button class="tab-btn active" data-tab="league">LoL Player Lookup</button>
      <button class="tab-btn" data-tab="aws">AWS Builder Profile</button>
      <button class="tab-btn" data-tab="project">My Current Project</button>
      <button class="tab-btn" data-tab="fun">Fun Facts About Me</button>
    </div>

    <!-- Tab Content Area -->
    <div class="tab-content">
      <!-- League Lookup Tab -->
      <div id="tab-league" class="tab-panel active">
        <h3>League Data Lookup</h3>
        <p>Enter a Riot ID to see their level, top champions, and insights.</p>

        <div class="league-layout"><!-- NEW outer 2-col wrapper -->
        <!-- Left: Lookup form block -->
        <aside class="league-left">
        <div id="lookup-message" class="lookup-message" style="display: none;"></div>

        <div class="lookup-form-container">
          <div class="form-group">
            <label for="summoner-name">Riot ID</label>
            <input type="text" id="summoner-name" name="summoner-name" placeholder="GameName#TAG" required>
            <small style="color: #687078;">Format: GameName#TAG</small>
          </div>

          <div class="form-group">
            <label for="region">Region</label>
            <select id="region" name="region">
              <option value="na1">NA</option>
              <option value="euw1" selected>EUW</option>
              <option value="eun1">EUNE</option>
              <option value="kr">Korea</option>
            </select>
          </div>

          <div class="form-actions">
            <button type="button" id="lookup-btn" class="lookup-submit-btn">Look Up Summoner</button>
            <button type="button" id="insights-btn" class="lookup-submit-btn secondary" disabled>Analyze Player</button>
            <span id="insights-message" class="lookup-message" style="display:none;"></span>
          </div>
        </div>
        </aside>

        <!-- Right: Results block (Summoner Info + Player Insights) -->
        <section class="league-right">
        <div id="summoner-results" class="summoner-results" style="display:none;">
        <div id="summary-row" class="summary-row">

          <!-- Left: Summoner Info + Top Champs -->
          <div class="summary-col">
            <h4>Summoner Info</h4>
            <div id="summoner-info"></div>
            <div id="champion-mastery"></div>  <!-- ‚Üê THIS must exist -->
          </div>

          <!-- Right: Player Insights -->
          <div id="player-insights" class="summary-col" style="display:none;">
            <h4>Player Insights</h4>
            <div id="insights-summary"></div>
            <div id="insights-tips"></div>
          </div>

        </div>
        </div>
        </section>
      </div>

      <!-- AWS Builder Tab -->
      <div id="tab-aws" class="tab-panel">
        <h3>My AWS Builder Profile</h3>
        <p>Check out my progress and community posts on AWS Builder Center.</p>
        <a href="https://builder.aws.com/community/@vixthewiz" target="_blank" class="cta-button">
          Visit my AWS Profile
        </a>
      </div>

      <!-- Current Project Tab -->
      <div id="tab-project" class="tab-panel">
        <h3>My Current Project</h3>
        <p>I'm working on the <strong>Rift Rewind Hackathon</strong> ‚Äì a League of Legends data experience powered by AWS!</p>
        <a href="https://builder.aws.com/content/32Z4SrTB8V1g0mMUGmyMUWXVgsu/rift-rewind-hackathon-on-aws-builder-center" target="_blank" class="cta-button">
          View Project Details
        </a>
      </div>

      <!-- Fun Facts Tab -->
      <div id="tab-fun" class="tab-panel">
        <h3>Fun Facts About Me</h3>
        <ul class="fun-list">
          <li>üöÄ AWS enthusiast & cloud builder.</li>
          <li>üí° Enjoys blending beauty, design & tech innovation.</li>
          <li>üéØ Always learning something new every day!</li>
        </ul>
      </div>
    </div>
  </section>
</main>


    <footer>
        <p>&copy; 2025 Victoria @VixTheWiz. Built with ‚ù§Ô∏è on AWS</p>
    </footer>
    
<script>    
// League Data Lookup - Calls Riot API via Lambda
const RIOT_API_URL = 'https://drkwtz22yumgqdhn2u5xa2knie0vijnw.lambda-url.us-east-1.on.aws/'; // Lambda Function URL

document.addEventListener('DOMContentLoaded', function() {
  const lookupBtn = document.getElementById('lookup-btn');
  const summonerNameInput = document.getElementById('summoner-name');
  const regionSelect = document.getElementById('region');

  lookupBtn.addEventListener('click', async function() {              
    const summonerName = summonerNameInput.value.trim();
    const region = regionSelect.value;
    const resultsDiv = document.getElementById('summoner-results');

    if (!summonerName) { showMessage('Please enter a Riot ID', 'error'); return; }
    if (!summonerName.includes('#')) { showMessage('Please use Riot ID format: GameName#TAG', 'error'); return; }

    // loading state
    lookupBtn.textContent = 'Looking up...';
    lookupBtn.disabled = true;
    document.getElementById('lookup-message').style.display = 'none';
    resultsDiv.style.display = 'none';

    try {
      const response = await fetch(RIOT_API_URL, {
        method: 'POST',
        headers: { 'Content-Type': 'application/json' },
        body: JSON.stringify({ summonerName, region })
      });

      const data = await response.json();

      if (response.ok) {
        try {
          await renderResultsSimple(data);
          showMessage('Summoner found!', 'success');
          document.getElementById('insights-btn').classList.add('active'); // Enable insights/analyze button
          document.getElementById('insights-btn').disabled = false;
        } catch (e) {
          console.error('[RR] renderResultsSimple failed:', e);
          showMessage('Render failed ‚Äî see console for details', 'error');
        }
        resultsDiv.style.display = 'block';
      } else {
        showMessage(data.error || 'Failed to fetch summoner data', 'error');
        document.getElementById('insights-btn').classList.remove('active'); // Disable insights/analyze button
      }
    } catch (err) {
      console.error('Lookup error:', err);
      showMessage('Network or server error. See console for details.', 'error');
    } finally {
      lookupBtn.textContent = 'Look Up Summoner';
      lookupBtn.disabled = false;
    }
  });

  // Enter key support
  summonerNameInput.addEventListener('keypress', function(e) {
    if (e.key === 'Enter') lookupBtn.click();
  });
});

function showMessage(text, type) {
  const messageDiv = document.getElementById('lookup-message');
  messageDiv.textContent = text;
  messageDiv.className = `lookup-message ${type}`;
  messageDiv.style.display = 'block';
  setTimeout(() => { messageDiv.style.display = 'none'; }, 10000);
}
</script>

</script>

<script>
async function renderResultsSimple(payload){
  const wrap    = document.getElementById('summoner-results');
  const info    = document.getElementById('summoner-info');
  // NEW ‚Äî write Top Champions into the insights column
  // Find or create the mastery container in the left column
  let mastery = document.getElementById('champion-mastery');
  if (!mastery) {
    const leftCol = document.querySelector('#summary-row .summary-col'); // first col
    if (leftCol) {
      mastery = document.createElement('div');
      mastery.id = 'champion-mastery';
      leftCol.appendChild(mastery);
    } else {
      console.error('[RR] Could not find left column to insert #champion-mastery');
      return; // bail safely
    }
  }
                  
  // Always show the section
  wrap.style.display = 'block';

  // ---- Summoner card ----
  const s = (payload && payload.summoner) || {};
  info.innerHTML = `
    <div class="summoner-card">
      <h5>${escapeHtml(s.name || 'Unknown Summoner')}</h5>
      <p>Level: ${s.level ?? s.summonerLevel ?? '‚Äî'}</p>
    </div>
  `;

  // Apply soft glow animation once lookup succeeds
  document.querySelector('.summoner-card')?.classList.add('active-glow');


  const champs = Array.isArray(payload?.topChampions) ? payload.topChampions : [];
  if (!champs.length){
    console.warn("[RR] No topChampions found in payload.");
    mastery.innerHTML = `
      <div class="subtle" style="padding:8px 0">No champion mastery data returned.</div>`;
    return;
  }

  // ---- DDragon: version + champ map ----
  let version = 'latest';
  try {
    const vers = await fetch('https://ddragon.leagueoflegends.com/api/versions.json').then(r=>r.json());
    version = Array.isArray(vers) && vers.length ? vers[0] : '14.19.1';
  } catch(e) {
    console.warn("[RR] Failed to get versions.json, falling back:", e);
    version = '14.19.1';
  }

  let mapByKey = {};
  try {
    const data = await fetch(`https://ddragon.leagueoflegends.com/cdn/${version}/data/en_US/champion.json`).then(r=>r.json());
    for (const id in data.data){
      const c = data.data[id];
      mapByKey[String(c.key)] = { slug: c.id, name: c.name };
    }
  } catch(e) {
    console.warn("[RR] Failed to load champion.json; will show numeric IDs:", e);
  }

  const cards = champs.map(c=>{
    const meta = mapByKey[String(c.championId)];
    const name = meta?.name ?? `ID ${c.championId}`;
    const slug = meta?.slug;
    const img  = slug ? `https://ddragon.leagueoflegends.com/cdn/${version}/img/champion/${slug}.png` : '';
    const lvl  = c.championLevel ?? '‚Äî';
    const pts  = (c.championPoints ?? 0).toLocaleString();

    return `
      <div class="champion-card">
        ${img ? `<img class="champ-icon" src="${img}" alt="${escapeHtml(name)}" width="64" height="64" loading="lazy">` : ''}
        <div>
          <div><strong>${escapeHtml(name)}</strong></div>
          <div class="subtle">Level ${lvl} ‚Ä¢ ${pts} pts</div>
        </div>
      </div>`;
  }).join('');

  mastery.innerHTML = `
    <h5>Top Champions</h5>
    <div class="champions-grid">${cards}</div>`;
}

function escapeHtml(s){
  return String(s ?? '').replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));
}
</script>

<script>
const INSIGHTS_URL = 'https://sh6nun3cs6vhhqmhjzloq6hz6y0jailk.lambda-url.us-east-1.on.aws/'; // Insights Lambda Function URL

document.addEventListener('DOMContentLoaded', function() {
  const btn = document.getElementById('insights-btn');
  const msg = document.getElementById('insights-message');

  btn.addEventListener('click', async function() {                      //Analyze Player (Insights) button
    const riotId = document.getElementById('summoner-name').value.trim();
    const region = document.getElementById('region').value;

    const analyzeBtn = document.getElementById('insights-btn');
    // reset analyze state for a new search
    analyzeBtn.textContent = 'Analyze Player';
    analyzeBtn.disabled = true;
    analyzeBtn.classList.remove('active');
    showInsightsMsg('', '', true); // hide chip
    // optionally clear previous insights content
    //document.getElementById('insights-summary').innerHTML = '';
    //document.getElementById('insights-topchamps').innerHTML = '';
    //document.getElementById('insights-tips').innerHTML = '';

    if (!riotId || !riotId.includes('#')) {
      showInsightsMsg('Please enter Riot ID as GameName#TAG', 'error');
      return;
    }

    btn.disabled = true;
    const original = btn.textContent;
    btn.textContent = 'Analyzing‚Ä¶';
    showInsightsMsg('', null, true);
    document.getElementById('player-insights').style.display = 'none';

    try {
    const res = await fetch(INSIGHTS_URL, {
    method: 'POST',
    headers: {'Content-Type': 'application/json'},
    body: JSON.stringify({ riotId, region, force: false })
    });

    const rawText = await res.text();
    console.log('[Insights] HTTP', res.status, rawText);

    let payload;
    try { payload = rawText ? JSON.parse(rawText) : {}; } catch { payload = {}; }

    // unwrap if Lambda returned {statusCode, body}
    if (payload && typeof payload === 'object' && 'body' in payload) {
      try { payload = JSON.parse(payload.body); } catch {}
    }

    if (!res.ok) {
      const msg = (payload && payload.error) || `Analysis failed (HTTP ${res.status}).`;
      showInsightsMsg(msg, 'error');
      document.getElementById('insights-btn').classList.remove('active');
      return;
    }

    if (!payload || !payload.summary) {
      showInsightsMsg('No insights returned. Check Lambda logs.', 'error');
      console.warn('[Insights] Unexpected payload:', payload);
      return;
    }

      renderInsights(payload);
      document.getElementById('player-insights').style.display = 'block';
      showInsightsMsg('Insights ready!', 'success');

    } catch (e) {
      console.error('[Insights] network error', e);
      showInsightsMsg('Network or server error.', 'error');
      document.getElementById('insights-btn').classList.remove('active');
    } finally {
      btn.textContent = 'Analyze Player';    // <- always restore
      }
    });

  // --- Safe version of showInsightsMsg that ensures element exists ----
function ensureInsightsMsgEl() {
  let el = document.getElementById('insights-message');
  if (!el) {
    el = document.createElement('span');
    el.id = 'insights-message';
    el.className = 'lookup-message';
    el.style.display = 'none';
    // place right after Analyze Player button
    const btn = document.getElementById('insights-btn');
    if (btn && btn.parentElement) {
      btn.parentElement.appendChild(el);
    } else {
      document.body.appendChild(el);
    }
  }
  return el;
}

function ensureInsightsMsgEl() {
  let el = document.getElementById('insights-message');
  if (!el) {
    el = document.createElement('span');
    el.id = 'insights-message';
    el.className = 'lookup-message';
    el.style.display = 'none';
    (document.getElementById('insights-btn')?.parentElement || document.body).appendChild(el);
  }
  return el;
}

let insightsHideTimer;
function showInsightsMsg(text, type, hide=false) {
  const msg = ensureInsightsMsgEl();
  msg.textContent = text || '';
  msg.className = 'lookup-message ' + (type || '');
  msg.id = 'insights-message';
  msg.style.display = hide ? 'none' : 'inline-block';
  clearTimeout(insightsHideTimer);
  if (!hide && text) insightsHideTimer = setTimeout(() => msg.style.display='none', 15000);
}

});

function renderInsights(data){
  const s = data.summary || {};
  const sumEl = document.getElementById('insights-summary');
  //const champsEl = document.getElementById('insights-topchamps');
  const tipsEl = document.getElementById('insights-tips');

  if (sumEl) {
    sumEl.innerHTML = `
      <div class="summoner-card">
        <p><strong>Region:</strong> ${escapeHtml(data.region || '‚Äî')}</p>
        <p><strong>Games:</strong> ${s.games ?? 0}
           ‚Ä¢ <strong>Wins:</strong> ${s.wins ?? 0}
           ‚Ä¢ <strong>Win Rate:</strong> ${((s.winRate ?? 0) * 100).toFixed(1)}%</p>
        <p><strong>Main Roles:</strong> ${fmtCounts(s.roleMix)}</p>
        <p><strong>Queues:</strong> ${fmtCounts(s.queueMix)}</p>
      </div>
    `;
  }

  if (tipsEl) {
    const tips = Array.isArray(data.coachingTips) ? data.coachingTips : [];
    tipsEl.innerHTML = tips.length
      ? `
        <h5 class="subtle">Coaching Tips</h5>
        <ul class="tips-list">
          ${tips.map(t => `<li>${escapeHtml(t)}</li>`).join('')}
        </ul>`
      : `<div class="subtle" style="padding:8px 0">No coaching tips yet.</div>`;
  }
}

// helper used above
function fmtCounts(obj){
  if (!obj || typeof obj !== 'object') return '‚Äî';
  const pairs = Object.entries(obj)
    .sort((a,b) => b[1]-a[1])
    .slice(0,3)
    .map(([k,v]) => `${escapeHtml(k)}: ${v}`);
  return pairs.length ? pairs.join(', ') : '‚Äî';
}

function fmtCounts(obj){
  if (!obj) return '‚Äî';
  const entries = Object.entries(obj);
  if (!entries.length) return '‚Äî';
  return entries.map(([k,v]) => `${escapeHtml(k)}: ${v}`).join(', ');
}

function escapeHtml(s){
  return String(s ?? '').replace(/[&<>"']/g, m => ({'&':'&amp;','<':'&lt;','>':'&gt;','"':'&quot;',"'":'&#39;'}[m]));
}
</script>


<script>
// Smooth scroll for all same-page links
document.querySelectorAll('a[href^="#"]').forEach(a => {
  a.addEventListener('click', e => {
    const targetId = a.getAttribute('href').slice(1);
    const targetEl = document.getElementById(targetId);
    if (targetEl) {
      e.preventDefault();
      targetEl.scrollIntoView({ behavior: 'smooth', block: 'start' });
    }
  });
});
</script>

<script>
// Simple Tab Toggle Logic
document.addEventListener('DOMContentLoaded', () => {
  const tabs = document.querySelectorAll('.tab-btn');
  const panels = document.querySelectorAll('.tab-panel');

  tabs.forEach(btn => {
    btn.addEventListener('click', () => {
      const target = btn.dataset.tab;
      tabs.forEach(b => b.classList.toggle('active', b === btn));
      panels.forEach(p => p.classList.toggle('active', p.id === `tab-${target}`));
    });
  });
});
</script>

<script>
// Smooth scroll + auto-activate League tab
document.addEventListener('DOMContentLoaded', () => {
  const scrollLink = document.querySelector('.scroll-link a[href="#league-lookup"]');
  if (!scrollLink) return;

  scrollLink.addEventListener('click', (e) => {
    e.preventDefault();

    // Activate the League tab if not active
    const leagueBtn = document.querySelector('.tab-btn[data-tab="league"]');
    const leaguePanel = document.getElementById('tab-league');
    document.querySelectorAll('.tab-btn').forEach(b => b.classList.remove('active'));
    document.querySelectorAll('.tab-panel').forEach(p => p.classList.remove('active'));
    leagueBtn.classList.add('active');
    leaguePanel.classList.add('active');

    // Smooth scroll to League section
    leaguePanel.scrollIntoView({ behavior: 'smooth', block: 'start' });
  });
});
</script>


</body>
</html>